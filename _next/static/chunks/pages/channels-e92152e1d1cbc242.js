(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[56],{600:(e,n,s)=>{"use strict";s.r(n),s.d(n,{default:()=>j});var a=s(7876),t=s(4232),o=s(6677),l=s(836),r=s(4420),c=s(5019);async function i(e,n){try{console.log("Connecting to:",e);let s=new r.E(e),a=await c.G.create({provider:s});await a.isReady,console.log("Connected to Subspace RPC.");let t=await a.query.messenger.channels.entries(n);console.log("Raw entries fetched (".concat(t.length,"):"),t),t.forEach((e,n)=>{let[s,a]=e;console.log("Decoded channel ".concat(n,":"),a.toHuman())});let o=t.map(e=>{let[n,s]=e;return s.toHuman()}).filter(e=>"object"==typeof e&&null!==e&&"channelId"in e);return console.log("Valid channels decoded: ".concat(o.length)),await a.disconnect(),console.log("Disconnected from RPC."),o}catch(e){return console.error("Error during fetchChannels:",e),[]}}var d=s(8005);let h=e=>{let{channel:n,parseNumber:s}=e,{channelId:t,state:o,nextInboxNonce:l,nextOutboxNonce:r,latestResponseReceivedMessageNonce:c,maxOutgoingMessages:i}=n,h=s(l),u=s(r),g=s(c),m=s(i),x=Math.max(0,u-1-g),j=Math.max(0,h-1),p=Math.max(0,u-1),v=m>0?Math.min(x/m*100,100):0;return(0,a.jsxs)("div",{className:"border rounded p-3 mb-4 shadow-sm bg-light",children:[(0,a.jsxs)("h5",{children:["Channel #",t]}),(0,a.jsxs)("p",{className:"mb-1",children:[(0,a.jsx)("strong",{children:"Status:"})," ",o]}),(0,a.jsxs)("p",{className:"mb-1",children:[(0,a.jsx)("strong",{children:"Capacity:"})," ",m.toLocaleString()]}),(0,a.jsxs)("p",{className:"mb-1",children:[(0,a.jsx)("strong",{children:"Inbound Messages:"})," ",j.toLocaleString()]}),(0,a.jsxs)("p",{className:"mb-1",children:[(0,a.jsx)("strong",{children:"Outbound Messages:"})," ",p.toLocaleString()]}),(0,a.jsxs)("p",{className:"mb-2",children:[(0,a.jsx)("strong",{children:"Pending Messages:"})," ",x.toLocaleString()]}),(0,a.jsx)(d.A,{now:v,label:"".concat(v.toFixed(1),"%"),variant:"primary"})]})},u=e=>{let{channels:n,parseNumber:s}=e;return(0,a.jsx)("div",{children:n.map(e=>(0,a.jsx)(h,{channel:e,parseNumber:s},e.channelId))})};var g=s(7867);let m=e=>{let{totalChannels:n,totalCapacity:s,totalInbound:t,totalOutbound:o,totalPending:l}=e,r=s>0?Math.min(l/s*100,100):0;return(0,a.jsx)(g.A,{className:"mb-4",children:(0,a.jsxs)(g.A.Body,{children:[(0,a.jsx)(g.A.Title,{children:"Chain Summary"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Total Channels:"})," ",n.toLocaleString()]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Total Capacity:"})," ",s.toLocaleString()]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Total Inbound Messages:"})," ",t.toLocaleString()]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Total Outbound Messages:"})," ",o.toLocaleString()]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("strong",{children:"Total Pending Messages:"})," ",l.toLocaleString()]}),(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("strong",{children:"Network Utilization:"}),(0,a.jsx)(d.A,{now:r,label:"".concat(r.toFixed(1),"%"),variant:r>90?"danger":r>80?"warning":"primary"})]})]})})};function x(e){return Math.max(0,parseInt((null==e?void 0:e.replace(/,/g,""))||"0",10))}function j(){let[e,n]=(0,t.useState)([]),[s,r]=(0,t.useState)(!0),[c,d]=(0,t.useState)("consensus"),{endpoint:h,destinationChainId:g}=(0,t.useMemo)(()=>({endpoint:"consensus"===c?"wss://rpc-0.taurus.subspace.network/ws":"wss://auto-evm.taurus.autonomys.xyz/ws",destinationChainId:"consensus"===c?{Domain:0}:{Consensus:0}}),[c]);(0,t.useEffect)(()=>{r(!0),i(h,g).then(e=>{let s=e.filter(e=>"object"==typeof e&&null!==e&&"channelId"in e);console.log("Valid channels passed to state:",s),n(s),r(!1)}).catch(e=>{console.error("Fetching channels failed:",e),r(!1)})},[h,g]);let j=(0,t.useMemo)(()=>{let n=0,s=0,a=0,t=0;return e.forEach(e=>{let o=x(e.maxOutgoingMessages),l=x(e.nextInboxNonce),r=x(e.nextOutboxNonce),c=x(e.latestResponseReceivedMessageNonce);n+=o,s+=Math.max(0,l-1),a+=Math.max(0,r-1),t+=Math.max(0,r-1-c)}),{totalChannels:e.length,totalCapacity:n,totalInbound:s,totalOutbound:a,totalPending:t}},[e]);return(0,a.jsxs)("div",{className:"container py-5",children:[(0,a.jsx)("h1",{children:"XDM Channels Status"}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"form-label me-3 fw-bold",children:"Select Network:"}),(0,a.jsxs)(o.A,{children:[(0,a.jsx)(l.A,{id:"toggle-consensus",type:"radio",variant:"consensus"===c?"primary":"outline-primary",name:"networkToggle",value:"consensus",checked:"consensus"===c,onChange:()=>d("consensus"),children:"Consensus Chain"}),(0,a.jsx)(l.A,{id:"toggle-autoevm",type:"radio",variant:"autoEvm"===c?"primary":"outline-primary",name:"networkToggle",value:"autoEvm",checked:"autoEvm"===c,onChange:()=>d("autoEvm"),children:"Auto EVM"})]})]}),!s&&e.length>0&&(0,a.jsx)(m,{...j}),s?(0,a.jsx)("div",{children:"Loading channel data..."}):0===e.length?(0,a.jsx)("div",{children:"No channel data available."}):(0,a.jsx)(u,{channels:e,parseNumber:x})]})}},7132:(e,n,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/channels",function(){return s(600)}])},7790:()=>{}},e=>{var n=n=>e(e.s=n);e.O(0,[622,548,636,593,792],()=>n(7132)),_N_E=e.O()}]);